'use strict';

var eccrypto = require('@toruslabs/eccrypto');
var BN = require('bn.js');
var utils = require('../utils.js');
var Point = require('./Point.js');

// These functions are here because BN can't be extended
const toPrivKeyEC = bn => utils.secp256k1.keyFromPrivate(bn.toString("hex", 64));
const toPrivKeyECC = bn => {
  const tmp = new BN(bn, "hex");
  return Buffer.from(tmp.toString("hex", 64), "hex");
};
const getPubKeyEC = bn => utils.secp256k1.keyFromPrivate(bn.toString("hex", 64)).getPublic();
const getPubKeyECC = bn => eccrypto.getPublic(toPrivKeyECC(bn));
const getPubKeyPoint = bn => {
  const pubKeyEc = getPubKeyEC(bn);
  return new Point(pubKeyEc.getX().toString("hex"), pubKeyEc.getY().toString("hex"));
};

exports.getPubKeyEC = getPubKeyEC;
exports.getPubKeyECC = getPubKeyECC;
exports.getPubKeyPoint = getPubKeyPoint;
exports.toPrivKeyEC = toPrivKeyEC;
exports.toPrivKeyECC = toPrivKeyECC;
