'use strict';

var enums = require('../utils/enums.js');
var DiscordHandler = require('./DiscordHandler.js');
var FacebookHandler = require('./FacebookHandler.js');
var GoogleHandler = require('./GoogleHandler.js');
var JwtHandler = require('./JwtHandler.js');
var MockLoginHandler = require('./MockLoginHandler.js');
var PasskeysHandler = require('./PasskeysHandler.js');
var PasswordlessHandler = require('./PasswordlessHandler.js');
var TwitchHandler = require('./TwitchHandler.js');
var Web3AuthPasswordlessHandler = require('./Web3AuthPasswordlessHandler.js');

const createHandler = params => {
  const {
    verifier,
    typeOfLogin,
    clientId,
    jwtParams
  } = params;
  if (!verifier || !typeOfLogin || !clientId) {
    throw new Error("Invalid params. Missing verifier, typeOfLogin or clientId");
  }
  const {
    domain,
    login_hint,
    id_token,
    access_token
  } = jwtParams || {};
  switch (typeOfLogin) {
    case enums.LOGIN.GOOGLE:
      return new GoogleHandler(params);
    case enums.LOGIN.FACEBOOK:
      return new FacebookHandler(params);
    case enums.LOGIN.TWITCH:
      return new TwitchHandler(params);
    case enums.LOGIN.DISCORD:
      return new DiscordHandler(params);
    case enums.LOGIN.EMAIL_PASSWORDLESS:
    case enums.LOGIN.SMS_PASSWORDLESS:
      if (!login_hint) throw new Error("Invalid params. Missing login_hint for web3auth passwordless login");
      return new Web3AuthPasswordlessHandler(params);
    case enums.LOGIN.PASSWORDLESS:
      if (!domain || !login_hint) throw new Error("Invalid params. Missing domain or login_hint for passwordless login");
      return new PasswordlessHandler(params);
    case enums.LOGIN.APPLE:
    case enums.LOGIN.GITHUB:
    case enums.LOGIN.LINKEDIN:
    case enums.LOGIN.TWITTER:
    case enums.LOGIN.WEIBO:
    case enums.LOGIN.LINE:
    case enums.LOGIN.EMAIL_PASSWORD:
    case enums.LOGIN.JWT:
    case enums.LOGIN.REDDIT:
      if (id_token || access_token) {
        return new MockLoginHandler(params);
      }
      if (!domain) throw new Error("Invalid params for jwt login. Missing domain");
      return new JwtHandler(params);
    case enums.LOGIN.PASSKEYS:
      return new PasskeysHandler(params);
    default:
      throw new Error("Unsupported login type");
  }
};
var createHandler$1 = createHandler;

module.exports = createHandler$1;
